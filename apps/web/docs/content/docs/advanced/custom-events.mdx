---
title: Custom Events
description: Learn how to implement and handle custom events in Discraft.
---

# Custom Events

Discraft leverages Discord.js's event-driven architecture, allowing your bot to react to various occurrences within Discord, such as messages being sent, members joining, or reactions being added. This guide explains how to define and handle custom events to extend your bot's functionality beyond basic commands.

## Event Structure

Events in Discraft are typically defined in separate files (e.g., `messageCreate.js` or `guildMemberAdd.ts`) within the `events/` directory of your project. Each event file exports a function that takes the `client` object as an argument.

This function then attaches listeners to specific Discord.js events using `client.on('eventName', callbackFunction)`.

## Defining a Simple Event Listener

Here's an example of a simple `ready` event listener, which fires when the bot successfully connects to Discord:

```javascript
discraft-js/templates/javascript/events/ready.js#L1-9
const { logger } = require("../utils/logger");

module.exports = (client) => {
  client.on("ready", () => {
    if (client.user) {
      logger.info(`Logged in as ${client.user.tag}!`);
    }
  });
};
```

In this example, when the bot is ready, it logs a message to the console.

## Handling `messageCreate` Events

The `messageCreate` event is one of the most commonly used events, as it triggers whenever a message is sent in a guild or a DM. You can use this to create prefix-based commands, respond to keywords, or implement content moderation.

```javascript
discraft-js/templates/javascript/events/messageCreate.js#L1-17
module.exports = (client) => {
  client.on("messageCreate", async (message) => {
    // Ignore messages from bots to prevent infinite loops
    if (message.author.bot) return;

    // Example: Respond to a specific keyword
    if (message.content.toLowerCase().includes("hello discraft")) {
      await message.reply("Hello there! How can I help you?");
    }

    // Example: Simple prefix command (though slash commands are preferred)
    const prefix = '!';
    if (message.content.startsWith(prefix + 'echo')) {
      const args = message.content.slice(prefix.length + 'echo'.length).trim();
      await message.channel.send(args);
    }
  });
};
```

## Handling Guild Events

Your bot can also react to events related to guilds (servers), such as a new member joining, a channel being created, or a role being updated.

### `guildMemberAdd` Event

This event is useful for sending welcome messages to new members or assigning default roles.

```javascript
/dev/null/events/guildMemberAdd.js#L1-10
const { EmbedBuilder } = require("discord.js");

module.exports = (client) => {
  client.on("guildMemberAdd", async (member) => {
    const channel = member.guild.channels.cache.find(ch => ch.name === 'welcome');
    if (!channel) return;

    const welcomeEmbed = new EmbedBuilder()
      .setTitle(`Welcome ${member.user.tag} to ${member.guild.name}!`);
    await channel.send({ embeds: [welcomeEmbed] });
  });
};
```

### `channelCreate` Event

This event allows your bot to perform actions when a new channel is created.

```javascript
/dev/null/events/channelCreate.js#L1-8
const { logger } = require("../utils/logger");

module.exports = (client) => {
  client.on("channelCreate", async (channel) => {
    logger.info(`New channel created: #${channel.name} in ${channel.guild ? channel.guild.name : 'DM'}`);
    // You could log this to a specific moderation channel or perform other actions.
  });
};
```

## Event Loading

Similar to commands, Discraft automatically loads event listeners from the `events/` directory (or your configured event path). Ensure your event files export a function that takes the `client` object.

## Error Handling in Events

When handling events, it's crucial to implement robust error handling to prevent your bot from crashing due to unexpected issues. You can use `try-catch` blocks within your event listener functions.

```javascript
/dev/null/events/messageReactionAdd.js#L1-19
module.exports = (client) => {
  client.on("messageReactionAdd", async (reaction, user) => {
    try {
      if (reaction.partial) await reaction.fetch();

      // Ignore reactions from bots
      if (user.bot) return;

      // Example: Log reaction
      console.log(`Reaction ${reaction.emoji.name} added to message ${reaction.message.id} by ${user.tag}`);

      // Further logic, e.g., role assignment based on reaction

    } catch (error) {
      console.error('Something went wrong when fetching the message or reaction:', error);
      // You might want to send a private message to an admin or log to a specific error channel.
    }
  });
};
```

## Best Practices

-   **Modularity:** Keep each event listener in its own file for clarity and maintainability.
-   **Intents:** Ensure your Discord client is initialized with the necessary [Gateway Intents](https://discord.com/developers/docs/topics/gateway#gateway-intents). Without the correct intents, your bot might not receive certain events.
-   **Partial Structures:** Be aware of [Partial Structures](https://discord.js.org/#/docs/discord.js/main/class/PartialGuildMember) in Discord.js, especially for events like `messageReactionAdd` or `guildMemberAdd` where the full data might not be cached. You may need to `fetch()` the full object.
-   **Error Logging:** Implement a comprehensive logging system to capture and review errors that occur during event processing.

## Next Steps

-   [Core Concepts: Event Handling](/docs/core-concepts/event-handling): Review the fundamental concepts behind Discraft's event handling.
-   [Advanced Topics: AI Integration](/docs/advanced-topics/ai-integration): Explore how to integrate AI capabilities, often triggered by events.
-   [API Reference: Event API](/docs/api-reference/event-api): Dive deeper into the available event-related API methods.