---
title: Custom Commands
description: Learn how to create and manage custom commands in Discraft.
---

# Custom Commands

Discraft provides a flexible system for defining and managing custom commands for your Discord bot. Commands are the primary way users interact with your bot, allowing them to trigger specific actions or retrieve information.

## Command Structure

Each command in Discraft is typically defined in its own file (e.g., `ping.js` or `userinfo.ts`) within the `commands/` directory of your project. A command file exports an object that defines the command's properties and behavior.

A basic command object includes:

-   `name`: The name of the command (lowercase, no spaces). This is what users will type (e.g., `/ping`).
-   `description`: A short description of what the command does.
-   `execute`: An asynchronous function that contains the logic to run when the command is invoked. This function receives the `interaction` object from Discord.js.

## Defining a Simple Command

Here's an example of a simple "ping" command:

```javascript
discraft-js/templates/javascript/commands/ping.js#L1-9
const command = {
  name: "ping",
  description: "Replies with Pong!",
  execute: async (interaction) => {
    await interaction.reply("Pong!");
  },
};

module.exports = command;
```

When a user types `/ping` in Discord, the `execute` function will be called, and the bot will respond with "Pong!".

## Handling Command Options

Many commands require additional information from the user. Discord Slash Commands support various types of options (strings, numbers, users, channels, etc.). To define options, you use the `data` property of your command, which is an instance of `SlashCommandBuilder` from `discord.js`.

### Adding a String Option

```javascript
/dev/null/commands/greet.js#L1-16
const { SlashCommandBuilder } = require("discord.js");

const command = {
  data: new SlashCommandBuilder()
    .setName("greet")
    .setDescription("Greets a specific user or the channel.")
    .addStringOption(option =>
      option.setName("message")
        .setDescription("The message to greet with.")
        .setRequired(true)
    ),
  execute: async (interaction) => {
    const message = interaction.options.getString("message");
    await interaction.reply(`You said: ${message}`);
  },
};

module.exports = command;
```

In the `execute` function, you can retrieve the value of an option using `interaction.options.get<Type>('optionName')`, where `<Type>` corresponds to the option type (e.g., `getString`, `getUser`, `getInteger`).

### Adding User and Channel Options

```javascript
/dev/null/commands/send.js#L1-26
const { SlashCommandBuilder } = require("discord.js");

const command = {
  data: new SlashCommandBuilder()
    .setName("send")
    .setDescription("Sends a message to a user or channel.")
    .addUserOption(option =>
      option.setName("target_user")
        .setDescription("The user to send the message to.")
        .setRequired(false)
    )
    .addChannelOption(option =>
      option.setName("target_channel")
        .setDescription("The channel to send the message to.")
        .setRequired(false)
    )
    .addStringOption(option =>
      option.setName("content")
        .setDescription("The content of the message.")
        .setRequired(true)
    ),
  execute: async (interaction) => {
    const user = interaction.options.getUser("target_user");
    const channel = interaction.options.getChannel("target_channel");
    const content = interaction.options.getString("content");

    if (user) {
      await user.send(content);
      await interaction.reply({ content: `Sent "${content}" to ${user.username}.`, ephemeral: true });
    } else if (channel) {
      await channel.send(content);
      await interaction.reply({ content: `Sent "${content}" to ${channel.name}.`, ephemeral: true });
    } else {
      await interaction.reply({ content: "Please specify a user or a channel.", ephemeral: true });
    }
  },
};

module.exports = command;
```

## Subcommands and Subcommand Groups

For commands with multiple related actions, Discord.js allows you to organize them using subcommands and subcommand groups. This keeps your command list clean and intuitive for users.

### Subcommands

A subcommand is a nested command under a main command. For example, a `user` command might have `info` and `avatar` subcommands (`/user info`, `/user avatar`).

```javascript
/dev/null/commands/user.js#L1-30
const { SlashCommandBuilder } = require("discord.js");

const command = {
  data: new SlashCommandBuilder()
    .setName("user")
    .setDescription("Provides information about users.")
    .addSubcommand(subcommand =>
      subcommand
        .setName("info")
        .setDescription("Get information about a user.")
        .addUserOption(option =>
          option.setName("target")
            .setDescription("The user to get info about")
            .setRequired(false)
        )
    )
    .addSubcommand(subcommand =>
      subcommand
        .setName("avatar")
        .setDescription("Get the avatar of a user.")
        .addUserOption(option =>
          option.setName("target")
            .setDescription("The user to get the avatar of")
            .setRequired(false)
        )
    ),
  async execute(interaction) {
    const subcommand = interaction.options.getSubcommand();
    const user = interaction.options.getUser("target") || interaction.user;

    if (subcommand === "info") {
      await interaction.reply(`User: ${user.username}, ID: ${user.id}`);
    } else if (subcommand === "avatar") {
      await interaction.reply(user.displayAvatarURL({ dynamic: true, size: 256 }));
    }
  },
};

module.exports = command;
```

To determine which subcommand was used, use `interaction.options.getSubcommand()`.

### Subcommand Groups

Subcommand groups allow for an additional level of nesting. For instance, a `settings` command could have a `user` group, which then contains `set-timezone` and `set-language` subcommands (`/settings user set-timezone`, `/settings user set-language`).

```javascript
/dev/null/commands/settings.js#L1-43
const { SlashCommandBuilder } = require("discord.js");

const command = {
  data: new SlashCommandBuilder()
    .setName("settings")
    .setDescription("Manage bot settings.")
    .addSubcommandGroup(group =>
      group
        .setName("user")
        .setDescription("Manage user-specific settings.")
        .addSubcommand(subcommand =>
          subcommand
            .setName("set-timezone")
            .setDescription("Set your preferred timezone.")
            .addStringOption(option =>
              option.setName("timezone")
                .setDescription("Your timezone (e.g., 'America/New_York')")
                .setRequired(true)
            )
        )
        .addSubcommand(subcommand =>
          subcommand
            .setName("set-language")
            .setDescription("Set your preferred language.")
            .addStringOption(option =>
              option.setName("language")
                .setDescription("Your language (e.g., 'en-US')")
                .setRequired(true)
            )
        )
    )
    .addSubcommandGroup(group =>
      group
        .setName("server")
        .setDescription("Manage server-specific settings (Admin only).")
        .addSubcommand(subcommand =>
          subcommand
            .setName("set-prefix")
            .setDescription("Set the bot's command prefix for this server.")
            .addStringOption(option =>
              option.setName("prefix")
                .setDescription("New command prefix (e.g., '!')")
                .setRequired(true)
            )
        )
    ),
  async execute(interaction) {
    const subcommandGroup = interaction.options.getSubcommandGroup();
    const subcommand = interaction.options.getSubcommand();

    if (subcommandGroup === "user") {
      if (subcommand === "set-timezone") {
        const timezone = interaction.options.getString("timezone");
        await interaction.reply(`Your timezone set to: ${timezone}`);
      } else if (subcommand === "set-language") {
        const language = interaction.options.getString("language");
        await interaction.reply(`Your language set to: ${language}`);
      }
    } else if (subcommandGroup === "server") {
      if (subcommand === "set-prefix") {
        // Implement admin check here
        const prefix = interaction.options.getString("prefix");
        await interaction.reply(`Server prefix set to: ${prefix}`);
      }
    }
  },
};

module.exports = command;
```

To access subcommand group and subcommand, use `interaction.options.getSubcommandGroup()` and `interaction.options.getSubcommand()`.

## Registering Commands

Discraft handles the automatic registration of your commands with Discord when your bot starts in development mode (`npm run dev`). For production, you will need to build your application, and the `build` command will handle the command registration.

## Best Practices

-   **Modularity:** Keep each command in its own file for better organization.
-   **Error Handling:** Implement `try-catch` blocks in your `execute` functions to gracefully handle errors during command execution.
-   **Ephemeral Replies:** For commands that only provide feedback to the user who invoked them (e.g., confirmation messages, error messages), consider using `interaction.reply({ content: "...", ephemeral: true })` to prevent spamming the channel.
-   **Permissions:** Use Discord.js's permission handling to restrict commands to certain roles or users.

## Next Steps

-   [Core Concepts: Command System](/docs/core-concepts/command-system): Review the fundamental concepts behind Discraft's command system.
-   [Advanced Topics: Custom Events](/docs/advanced-topics/custom-events): Learn how to define and handle custom events.
-   [API Reference: Command API](/docs/api-reference/command-api): Dive deeper into the available command-related API methods.